<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet"/>
    <link rel="stylesheet" href="css/Site.css"/>
    <link rel="stylesheet" href="css/zy.all.css"/>
    <link rel="stylesheet" href="css/font-awesome.min.css"/>
    <link rel="stylesheet" href="css/amazeui.min.css"/>
    <link rel="stylesheet" href="css/admin.css"/>

</head>

<body>
<div class="dvcontent">
    <div>
        <!--tab start-->
        <div class="tabs3" style="margin: 30px;">
            <div class="hd">
                <ul>
                    <li class="" style="box-sizing: initial;-webkit-box-sizing: initial;">商品信息更新</li>
                </ul>
            </div>
            <div class="bd">
                <ul class="theme-popbod dform" style="display: none;">
                    <div class="am-cf admin-main" style="padding-top: 0px;">
                        <!-- content start -->

                        <div class="am-cf admin-main" style="padding-top: 0px;">
                            <!-- content start -->
                            <div class="admin-content">
                                <div class="admin-content-body">

                                    <div class="am-g">
                                        <div class="am-u-sm-12 am-u-md-4 am-u-md-push-8">

                                        </div>
                                        <div class="am-u-sm-12 am-u-md-8 am-u-md-pull-4"
                                             style="padding-top: 30px;">
                                            <form class="am-form am-form-horizontal"
                                                  action="updategoods" method="post">

                                                <div class="am-form-group">
                                                    <label for="goodsID" class="am-u-sm-3 am-form-label">
                                                        需更新商品ID</label>
                                                    <div class="am-u-sm-9">
                                                        <input type="text" id="goodsID" required
                                                               placeholder="商品商品ID" name="goodsID">
                                                        <small>商品ID</small>
                                                    </div>
                                                </div>

                                                <div class="am-form-group">
                                                    <label for="name" class="am-u-sm-3 am-form-label">
                                                        商品名称</label>
                                                    <div class="am-u-sm-9">
                                                        <input type="text" id="name" required
                                                               placeholder="商品名称" name="name">
                                                        <small>商品</small>
                                                    </div>
                                                </div>

                                                <div class="am-form-group">
                                                    <label for="stock" class="am-u-sm-3 am-form-label">
                                                        需更新库存</label>
                                                    <div class="am-u-sm-9">
                                                        <input type="text" id="stock" required
                                                               placeholder="库存" name="stock">
                                                        <small>库存</small>
                                                    </div>
                                                </div>
                                                <div class="am-form-group">
                                                    <label for="introduce" class="am-u-sm-3 am-form-label">
                                                        需更新商品介绍</label>
                                                    <div class="am-u-sm-9">
                                                        <input type="text" id="introduce" required
                                                               placeholder="商品介绍" name="introduce">
                                                        <small>商品介绍</small>
                                                    </div>
                                                </div>
                                                <div class="am-form-group">
                                                    <label for="unit" class="am-u-sm-3 am-form-label">
                                                        需更新商品单位</label>
                                                    <div class="am-u-sm-9">
                                                        <input type="text" id="unit" required
                                                               placeholder="商品单位" name="unit">
                                                        <small>商品单位</small>
                                                    </div>
                                                </div>
                                                <div class="am-form-group">
                                                    <label for="price" class="am-u-sm-3 am-form-label">
                                                        需更新商品价格</label>
                                                    <div class="am-u-sm-9">
                                                        <input type="text" id="price" required
                                                               placeholder="商品价格" name="price">
                                                        <small>商品价格</small>
                                                    </div>
                                                </div>
                                                <div class="am-form-group">
                                                    <label for="discount" class="am-u-sm-3 am-form-label">
                                                        需更新商品折扣</label>
                                                    <div class="am-u-sm-9">
                                                        <input type="text" id="discount" required
                                                               placeholder="商品折扣" name="discount">
                                                        <small>商品折扣</small>
                                                    </div>
                                                </div>
                                                <div class="am-form-group">
                                                    <div class="am-u-sm-9 am-u-sm-push-3">
                                                        <input type="submit" class="am-btn am-btn-success"
                                                               value="更新商品"/>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>

                                </div>
                                <!-- content end -->
                            </div>
                        </div>
                    </div>
                    <!--tab end-->
                </ul>

                <script src="js/jquery-1.7.2.min.js" type="text/javascript"></script>
                <script src="js/plugs/Jqueryplugs.js" type="text/javascript"></script>
                <script src="js/_layout.js"></script>
                <script src="js/plugs/jquery.SuperSlide.source.js"></script>
                <script>
                    jQuery(function () {
                        $.ajax({
                            //$就表示jQuery库
                            url: "browseGoods",
                            type: "get",
                            dataType: "json",
                            //后台执行成功之后，执行此函数
                            success: function (data) {
                                console.log(data);
                                // console.log(data.length);
                                var s = "";
                                for (var i = 0; i < data.length; i++) {
                                    s += "<tr >";
                                    s += "<td id = \"infoTr\">" + data[i].id + "</td>";
                                    s += "<td>" + data[i].name + "</td>";
                                    s += "<td>" + data[i]["introduce"] + "</td>";
                                    s += "<td>" + data[i].stock + "</td>";
                                    s += "<td>" + data[i].unit + "</td>";
                                    s += "<td>" + data[i].price + "</td>";
                                    s += "<td>" + data[i].discount + "</td>";
                                    s += "<td class=\"update\"><button onclick=\"updateInfo('" + data[i].id + " ')\" >" +
                                        "<i class=\"icon-trash bigger-120\"></i>更新</button></td>";
                                    s += "<td class=\"delete\"><button onclick=\"deleteInfo('" + data[i].id + " ')\" >" +
                                        "<i class=\"icon-trash bigger-120\"></i>下架</button></td>";
                                    s += "</tr>";
                                }
                                console.log(s);
                                $("#tbRecord>tbody").html(s);
                            }
                        })
                    });

                    function updateInfo(obj) {
                        console.log(obj);
                        $.ajax({
                            type: "POST",
                            url: "goodsBrowse.html",
                            async: false,//同步：意思是当有返回值以后才会进行后面的js程序。
                            data: {"id": obj},
                            success: function (msg) {
                                if (msg) {//根据返回值进行跳转
                                    window.location.href = 'updategoods.html';
                                }
                            }
                        })
                    }

                    function deleteInfo(obj) {
                        console.log(obj);
                        $.ajax({
                            url: "delGoods",
                            type: "post",
                            data: {"id": obj},//传给servlet的数据
                            success: function () {
                                alert("删除成功");
                                window.location.reload();
                            },
                            error: function () {
                                alert("删除失败");
                            }
                        })
                    }
                </script>
            </div>
        </div>
    </div>
</div>
</body>
</html>